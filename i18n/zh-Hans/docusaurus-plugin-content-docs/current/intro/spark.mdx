---
title: ⚡ Spark
id: spark
---

## 主线程性能分析

Spark 所显示的数据有时并不能完全反映真实情况。你可能会观察到一些归属于CraftEngine的性能开销，实际上并非由插件本身直接造成。这一点不应归咎于Spark，毕竟这和其底层工作机制有关。

在进行主线程性能分析时，如果您遇到疑似与CraftEngine相关的问题，建议先排除以下常见干扰项（下图取样于500名真实玩家同时在线的服务器环境）：

1. 以 Injected 开头的类（图中红色标记部分）
这些类是CraftEngine为优化特定效果而对服务端原有类进行的注入。因此，部分原本属于服务端的性能消耗，在分析中会被计入CraftEngine。

2. API 调用（图中绿色标记部分）
当您通过CraftEngine API监听事件或构建物品时，相应耗时在性能分析中也会被归入CraftEngine名下。

![](/img/spark_1.png)